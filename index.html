<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Planning & Cost Control Department</title>

<link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

<style>
body { font-family: "Segoe UI", sans-serif; overflow-x:hidden; scroll-behavior:smooth; }
nav { background:white; box-shadow:0 2px 10px rgba(0,0,0,0.1); position:fixed; width:100%; top:0; z-index:50; animation: slideDown 0.8s ease-out; }
.nav-container { max-width:1200px; margin:0 auto; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; }
.nav-container a { margin-left:1rem; text-decoration:none; color:#4b5563; font-weight:500; transition: all 0.3s ease; position: relative; }
.nav-container a:hover { color:#2563eb; transform: translateY(-2px); }
.nav-container a::after { content: ''; position: absolute; width: 0; height: 2px; background: #2563eb; left: 0; bottom: -5px; transition: width 0.3s ease; }
.nav-container a:hover::after { width: 100%; }

.hero { height:100vh; background:linear-gradient(135deg,#1e3a8a 0%,#2563eb 100%); display:flex; align-items:center; justify-content:center; text-align:center; color:white; padding:0 2rem; position:relative; overflow: hidden; }
.hero h1 { animation: fadeInUp 1s ease-out 0.3s both; opacity: 0; }
.hero p { animation: fadeInUp 1s ease-out 0.6s both; opacity: 0; }
.hero .cta-button { animation: fadeInUp 1s ease-out 0.9s both; opacity: 0; }

.cta-button { display:inline-block; background:white; color:#2563eb; padding:0.75rem 2rem; border-radius:0.5rem; text-decoration:none; font-weight:600; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; overflow: hidden; }
.cta-button:hover { transform:translateY(-5px) scale(1.05); box-shadow:0 15px 30px rgba(0,0,0,0.3); }
.cta-button::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.7s ease; }
.cta-button:hover::before { left: 100%; }

.section { padding:5rem 2rem; max-width:1200px; margin:0 auto; }
.section-title { text-align:center; font-size:2.5rem; margin-bottom:3rem; position: relative; }
.section-title::after { content: ''; position: absolute; width: 80px; height: 4px; background: #2563eb; bottom: -15px; left: 50%; transform: translateX(-50%); border-radius: 2px; animation: lineExpand 1s ease-out 0.5s both; }

.functions-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:2rem; }
.func-card { background:#3b82f6; border-radius:1rem; padding:1.5rem; color:white; font-weight:600; text-align:center; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor:pointer; position: relative; overflow: hidden; }
.func-card::before { content: ''; position: absolute; width: 100%; height: 100%; background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%); top: 0; left: -100%; transition: left 0.7s ease; }
.func-card:hover::before { left: 100%; }
.func-card:hover { transform:scale(1.05) rotate(2deg); background:#2563eb; box-shadow:0 20px 40px rgba(0,0,0,0.3); }

.report-card { transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor:pointer; background:white; border-radius:2rem; padding:2rem; text-align:center; position: relative; overflow: hidden; border: 2px solid transparent; }
.report-card:hover { transform:translateY(-15px) scale(1.05); box-shadow:0 30px 60px rgba(0,0,0,.2); background:linear-gradient(135deg,#3b82f6,#60a5fa); color:white; border-color: rgba(255,255,255,0.2); }
.report-card .text-5xl { transition: transform 0.5s ease; }
.report-card:hover .text-5xl { transform: scale(1.2) rotate(10deg); }

.bg-blue-section { background:linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%); color:white; position: relative; }
footer { background:#1e3a8a; color:white; text-align:center; padding:2rem; margin-top:2rem; }

/* Enhanced Report Viewer Styles */
#viewer {
    display: none;
    position: relative;
    padding-top: 2rem;
    animation: fadeIn 0.8s ease;
}

#reportFrame {
    width: 100%;
    height: 80vh;
    border: none;
    border-radius: 1rem;
    animation: fadeIn 0.8s ease;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    transition: opacity 0.5s ease;
}

.viewer-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding: 1rem;
    background: white;
    border-radius: 1rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
}

.viewer-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e3a8a;
}

.close-btn {
    background: #dc2626;
    color: white;
    border: none;
    padding: 0.5rem 1.5rem;
    border-radius: 0.5rem;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.close-btn:hover {
    background: #b91c1c;
    transform: scale(1.05);
}

.loading-indicator {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.loading-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid #e5e7eb;
    border-top: 5px solid #2563eb;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 20px;
}

/* About Section Styles */
.about-card {
    background: white;
    border-radius: 1.5rem;
    padding: 2.5rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    height: 100%;
    border: 2px solid transparent;
    position: relative;
    overflow: hidden;
}

.about-card::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 5px;
    background: linear-gradient(90deg, #3b82f6, #60a5fa);
    bottom: 0;
    left: 0;
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.5s ease;
}

.about-card:hover::after {
    transform: scaleX(1);
}

.about-card:hover {
    transform: translateY(-15px);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
    background: linear-gradient(135deg, #3b82f6, #60a5fa);
    color: white;
    border-color: rgba(255, 255, 255, 0.2);
}

.about-card:hover .icon-container {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1) rotate(360deg);
}

.about-card:hover .card-icon {
    color: white;
    transform: scale(1.2);
}

.icon-container {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.card-icon {
    font-size: 2rem;
    color: #2563eb;
    transition: all 0.6s ease;
}

.stat-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 1rem;
    padding: 1.5rem;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.4s ease;
    animation: pulseGlow 2s infinite;
}

.stat-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.2);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

.stat-number {
    font-size: 2.5rem;
    font-weight: 700;
    color: white;
    line-height: 1;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.9;
    margin-top: 0.5rem;
}

/* Contact Info Cards */
.contact-card {
    background: white;
    border-radius: 1.5rem;
    padding: 2rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border-left: 5px solid #2563eb;
    position: relative;
    overflow: hidden;
}

.contact-card::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent 30%, rgba(59, 130, 246, 0.05) 50%, transparent 70%);
    top: 0;
    left: -100%;
    transition: left 0.7s ease;
}

.contact-card:hover::before {
    left: 100%;
}

.contact-card:hover {
    transform: translateY(-10px) rotate(1deg);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
    border-left: 5px solid #60a5fa;
}

.contact-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #e0f2fe;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.5rem;
    transition: all 0.4s ease;
}

.contact-card:hover .contact-icon {
    transform: scale(1.1) rotate(10deg);
    background: #3b82f6;
}

.contact-card:hover .contact-icon span {
    color: white;
}

/* Process Steps Animation */
.process-step {
    position: relative;
    padding-left: 2.5rem;
    margin-bottom: 2rem;
    animation: fadeInRight 0.8s ease-out both;
}

.process-step:nth-child(1) { animation-delay: 0.2s; }
.process-step:nth-child(2) { animation-delay: 0.4s; }
.process-step:nth-child(3) { animation-delay: 0.6s; }

.process-step::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #2563eb;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    animation: pulse 2s infinite;
}

.process-step:nth-child(1)::before { content: '1'; }
.process-step:nth-child(2)::before { content: '2'; }
.process-step:nth-child(3)::before { content: '3'; }

/* Floating Animation for Hero Elements */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
}

.floating {
    animation: float 6s ease-in-out infinite;
}

/* Keyframes */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInRight {
    from {
        opacity: 0;
        transform: translateX(-30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-100%);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes lineExpand {
    from {
        width: 0;
    }
    to {
        width: 80px;
    }
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

@keyframes pulseGlow {
    0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0); }
    50% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.3); }
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes blobFloat {
    0%, 100% { transform: translate(0px, 0px) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
}

/* Typewriter Effect */
.typewriter {
    overflow: hidden;
    border-right: .15em solid #2563eb;
    white-space: nowrap;
    animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite;
}

@keyframes typing {
    from { width: 0 }
    to { width: 100% }
}

@keyframes blink-caret {
    from, to { border-color: transparent }
    50% { border-color: #2563eb; }
}

/* Scroll Indicator */
.scroll-indicator {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
    40% { transform: translateX(-50%) translateY(-10px); }
    60% { transform: translateX(-50%) translateY(-5px); }
}

/* Hover Effects for Lists */
.service-item {
    position: relative;
    padding-left: 1.5rem;
    transition: all 0.3s ease;
}

.service-item::before {
    content: '‚Üí';
    position: absolute;
    left: 0;
    transition: transform 0.3s ease;
}

.service-item:hover {
    transform: translateX(10px);
    color: #2563eb;
}

.service-item:hover::before {
    transform: translateX(5px);
    color: #2563eb;
}

@media (max-width:768px){ 
    .hero h1{font-size:2rem;}
    .about-card { padding: 1.5rem; }
    .contact-card { padding: 1.5rem; }
    .section-title { font-size: 2rem; }
}
</style>
</head>

<body>

<!-- NAV -->
<nav>
  <div class="nav-container">
    <a href="#home" class="text-2xl font-bold text-blue-700">Planning & Cost Control</a>
    <div>
      <a href="#reports">Reports</a>
      <a href="#functions">Functions</a>
      <a href="#about">About</a>
      <a href="#contact">Information</a>
    </div>
  </div>
</nav>

<!-- HERO -->
<section id="home" class="hero">
  <div class="relative z-10 text-center px-6">
    <h1 class="text-5xl md:text-6xl font-bold mb-4 typewriter">Planning & Cost Control Department</h1>
    <p class="text-xl md:text-2xl mb-8 text-white/90">
      Efficient Planning, Cost Control & Performance Visibility
    </p>
    <a href="#reports" class="cta-button">View Reports</a>
  </div>
  
  <!-- Floating Elements -->
  <div class="absolute top-1/4 left-10 w-8 h-8 bg-white/20 rounded-full floating" style="animation-delay: 0s;"></div>
  <div class="absolute bottom-1/4 right-20 w-12 h-12 bg-white/10 rounded-full floating" style="animation-delay: 1s;"></div>
  <div class="absolute top-1/3 right-1/4 w-6 h-6 bg-white/15 rounded-full floating" style="animation-delay: 2s;"></div>
  
  <!-- Scroll Indicator -->
  <div class="scroll-indicator">
    <div class="text-white animate-bounce">
      <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
      </svg>
    </div>
  </div>
  
  <canvas id="blobCanvas" class="absolute inset-0"></canvas>
</section>

<!-- REPORTS -->
<section id="reports" class="section bg-gray-50">
  <h2 class="section-title" data-aos="fade-up">Reports</h2>

  <div class="grid md:grid-cols-2 gap-10 max-w-6xl mx-auto">
    <div class="report-card" onclick="openReport('internal')" data-aos="fade-right" data-aos-delay="200">
      <div class="text-5xl mb-4">üìä</div>
      <h3 class="text-2xl font-bold mb-3">Internal vs Target 2025</h3>
      <p>Compares planned targets with actual earned values monthly.</p>
      <div class="mt-6">
        <div class="bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold inline-block transform transition-transform hover:scale-105">
          Open Dashboard
        </div>
        <div class="mt-3 text-sm text-gray-500">
          <span class="inline-flex items-center">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
            </svg>
            Last updated: Today
          </span>
        </div>
      </div>
    </div>

    <div class="report-card" onclick="openReport('issue')" data-aos="fade-left" data-aos-delay="200">
      <div class="text-5xl mb-4">‚ö†Ô∏è</div>
      <h3 class="text-2xl font-bold mb-3">Issue Tracking Dashboard</h3>
      <p>Consolidated view of project issues, risks, and mitigation status.</p>
      <div class="mt-6">
        <div class="bg-green-700 text-white px-6 py-3 rounded-xl font-semibold inline-block transform transition-transform hover:scale-105">
          Open Dashboard
        </div>
        <div class="mt-3 text-sm text-gray-500">
          <span class="inline-flex items-center">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
            </svg>
            Real-time updates
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Report Viewer -->
  <div id="viewer" class="relative">
    <div class="viewer-header">
      <div class="viewer-title">Report Viewer</div>
      <button class="close-btn" onclick="closeReport()">Close Report</button>
    </div>
    <div id="loadingIndicator" class="loading-indicator" style="display: none;">
      <div class="loading-spinner"></div>
      <p>Loading Power BI Report...</p>
    </div>
    <iframe id="reportFrame" title="Power BI Report"></iframe>
  </div>
</section>

<!-- FUNCTIONS -->
<section id="functions" class="section">
  <h2 class="section-title" data-aos="fade-up">Our Key Functions</h2>
  <div class="functions-grid">
    <div class="func-card" data-aos="fade-up" data-aos-delay="100">Project Planning</div>
    <div class="func-card" data-aos="fade-up" data-aos-delay="200">Cost Control</div>
    <div class="func-card" data-aos="fade-up" data-aos-delay="300">Scheduling</div>
    <div class="func-card" data-aos="fade-up" data-aos-delay="400">Reporting</div>
  </div>
</section>

<!-- ABOUT SECTION -->
<section id="about" class="section bg-blue-section">
  <div class="max-w-6xl mx-auto">
    <h2 class="section-title text-white" data-aos="fade-up">About Our Department</h2>
    
    <div class="text-center max-w-3xl mx-auto mb-16" data-aos="fade-up" data-aos-delay="100">
      <p class="text-xl text-white/90">
        We ensure disciplined execution of projects through strategic planning, 
        rigorous cost governance, and comprehensive performance tracking, 
        delivering clear visibility and data-driven insights for informed decision-making.
      </p>
    </div>

    <!-- Stats Section -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-16">
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="150">
        <div class="stat-number">150+</div>
        <div class="stat-label">Projects Managed</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
        <div class="stat-number">99.8%</div>
        <div class="stat-label">Budget Accuracy</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="250">
        <div class="stat-number">24/7</div>
        <div class="stat-label">Monitoring</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
        <div class="stat-number">50+</div>
        <div class="stat-label">Team Members</div>
      </div>
    </div>

    <!-- Cards Grid -->
    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
      <!-- Card 1 -->
      <div class="about-card" data-aos="flip-left" data-aos-delay="200">
        <div class="icon-container">
          <span class="card-icon">üìê</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-center">Strategic Planning</h3>
        <p class="text-gray-600 text-center">
          Integrated project schedules aligned with milestones, resources, 
          and organizational objectives for optimal execution.
        </p>
      </div>

      <!-- Card 2 -->
      <div class="about-card" data-aos="flip-left" data-aos-delay="300">
        <div class="icon-container">
          <span class="card-icon">üí∞</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-center">Cost Governance</h3>
        <p class="text-gray-600 text-center">
          Proactive budget control, forecasting, and variation management 
          to protect project profitability and financial integrity.
        </p>
      </div>

      <!-- Card 3 -->
      <div class="about-card" data-aos="flip-left" data-aos-delay="400">
        <div class="icon-container">
          <span class="card-icon">üìä</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-center">Progress Tracking</h3>
        <p class="text-gray-600 text-center">
          Accurate physical and financial progress measurement using KPIs, 
          earned value analysis, and real-time dashboards.
        </p>
      </div>

      <!-- Card 4 -->
      <div class="about-card" data-aos="flip-left" data-aos-delay="500">
        <div class="icon-container">
          <span class="card-icon">üìà</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-center">Executive Reporting</h3>
        <p class="text-gray-600 text-center">
          Clear, concise, and actionable reports that support 
          data-driven decision making at all management levels.
        </p>
      </div>
    </div>

    <!-- Mission Statement -->
    <div class="mt-20 p-8 rounded-2xl bg-white/10 backdrop-blur-sm border border-white/20" data-aos="fade-up" data-aos-delay="300">
      <div class="flex flex-col md:flex-row items-center gap-8">
        <div class="flex-1">
          <h3 class="text-2xl font-bold mb-4" data-aos="fade-right">Our Mission</h3>
          <p class="text-white/90 mb-4" data-aos="fade-right" data-aos-delay="100">
            To deliver exceptional planning and cost control services that 
            ensure project success through disciplined execution, transparent 
            reporting, and continuous optimization of resources.
          </p>
          <div class="flex items-center gap-4 mt-6" data-aos="fade-right" data-aos-delay="200">
            <div class="w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center animate-pulse">
              <span class="text-white text-xl">‚úì</span>
            </div>
            <div>
              <h4 class="font-bold">Quality Assurance</h4>
              <p class="text-sm text-white/80">ISO 9001:2015 Certified Processes</p>
            </div>
          </div>
        </div>
        <div class="md:w-1/3" data-aos="fade-left" data-aos-delay="300">
          <div class="bg-white/20 p-6 rounded-xl">
            <h4 class="font-bold mb-3">Core Values</h4>
            <ul class="space-y-2 text-white/90">
              <li class="service-item flex items-center gap-2">
                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                Integrity & Transparency
              </li>
              <li class="service-item flex items-center gap-2">
                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                Excellence & Precision
              </li>
              <li class="service-item flex items-center gap-2">
                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                Collaboration & Teamwork
              </li>
              <li class="service-item flex items-center gap-2">
                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                Innovation & Improvement
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CONTACT & INFORMATION SECTION -->
<section id="contact" class="section bg-gray-50">
  <div class="max-w-6xl mx-auto">
    <h2 class="section-title" data-aos="fade-up">Department Information</h2>
    
    <!-- Contact Information Cards -->
    <div class="grid md:grid-cols-3 gap-8 mb-16">
      <!-- Card 1 - Location -->
      <div class="contact-card" data-aos="flip-up" data-aos-delay="100">
        <div class="contact-icon">
          <span class="text-blue-600 text-2xl">üìç</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-gray-800">Location</h3>
        <p class="text-gray-600 mb-4">
          Alrwawaf Contracting Company<br>
          Buraidah, Al-Qassim<br>
          Saudi Arabia
        </p>
        <div class="mt-4 p-3 bg-blue-50 rounded-lg">
          <p class="text-sm text-gray-600">
            <span class="font-semibold">Office Hours:</span><br>
            Sunday - Thursday: 8:00 AM - 5:00 PM
          </p>
        </div>
      </div>

      <!-- Card 2 - Contact Details -->
      <div class="contact-card" data-aos="flip-up" data-aos-delay="200">
        <div class="contact-icon">
          <span class="text-blue-600 text-2xl">üìû</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-gray-800">Contact Details</h3>
        <div class="space-y-3">
          <div>
            <p class="font-semibold text-gray-700">Planning Department</p>
            <p class="text-gray-600">planning@alrwawaf.com</p>
          </div>
          <div>
            <p class="font-semibold text-gray-700">Cost Control Unit</p>
            <p class="text-gray-600">costcontrol@alrwawaf.com</p>
          </div>
          <div>
            <p class="font-semibold text-gray-700">Phone</p>
            <p class="text-gray-600">+966 XX XXX XXXX</p>
          </div>
        </div>
      </div>

      <!-- Card 3 - Report Access -->
      <div class="contact-card" data-aos="flip-up" data-aos-delay="300">
        <div class="contact-icon">
          <span class="text-blue-600 text-2xl">üîê</span>
        </div>
        <h3 class="text-xl font-bold mb-3 text-gray-800">Report Access</h3>
        <p class="text-gray-600 mb-4">
          All reports require authorized access. Contact the department head for credentials.
        </p>
        <div class="mt-4 p-3 bg-green-50 rounded-lg">
          <p class="text-sm text-gray-600">
            <span class="font-semibold">Note:</span> Reports are updated daily at 2:00 AM GMT+3
          </p>
        </div>
      </div>
    </div>

    <!-- Report Access Process -->
    <div class="bg-white rounded-2xl p-8 shadow-lg" data-aos="fade-up" data-aos-delay="150">
      <h3 class="text-2xl font-bold mb-6 text-gray-800">Report Access Procedure</h3>
      
      <div class="grid md:grid-cols-3 gap-8">
        <!-- Step 1 -->
        <div class="text-center" data-aos="zoom-in" data-aos-delay="100">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
            <span class="text-blue-600 text-2xl font-bold">1</span>
          </div>
          <h4 class="font-bold text-gray-800 mb-2">Request Access</h4>
          <p class="text-gray-600">
            Send an email to the department head with your name, department, and purpose of access.
          </p>
        </div>

        <!-- Step 2 -->
        <div class="text-center" data-aos="zoom-in" data-aos-delay="200">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse" style="animation-delay: 0.5s;">
            <span class="text-blue-600 text-2xl font-bold">2</span>
          </div>
          <h4 class="font-bold text-gray-800 mb-2">Approval Process</h4>
          <p class="text-gray-600">
            Access requests are reviewed within 24 hours. You'll receive confirmation via email.
          </p>
        </div>

        <!-- Step 3 -->
        <div class="text-center" data-aos="zoom-in" data-aos-delay="300">
          <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse" style="animation-delay: 1s;">
            <span class="text-blue-600 text-2xl font-bold">3</span>
          </div>
          <h4 class="font-bold text-gray-800 mb-2">Get Credentials</h4>
          <p class="text-gray-600">
            Once approved, you'll receive login credentials and access instructions.
          </p>
        </div>
      </div>

      <div class="mt-8 p-6 bg-blue-50 rounded-xl" data-aos="fade-up" data-aos-delay="400">
        <div class="flex items-start gap-4">
          <div class="text-2xl animate-bounce">‚ÑπÔ∏è</div>
          <div>
            <h4 class="font-bold text-gray-800 mb-2">Important Information</h4>
            <p class="text-gray-600">
              All report data is confidential and intended for internal use only. 
              Unauthorized distribution is strictly prohibited. Reports are optimized 
              for Chrome and Edge browsers.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Department Services -->
    <div class="mt-16" data-aos="fade-up">
      <h3 class="text-2xl font-bold mb-8 text-center text-gray-800">Department Services</h3>
      
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-white p-6 rounded-xl shadow-md" data-aos="fade-right" data-aos-delay="100">
          <h4 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
            <span class="text-green-600 text-xl animate-pulse">‚úì</span> Planning Services
          </h4>
          <ul class="space-y-2 text-gray-600">
            <li class="service-item">Project Schedule Development</li>
            <li class="service-item">Resource Planning & Allocation</li>
            <li class="service-item">Milestone Tracking & Management</li>
            <li class="service-item">Progress Measurement Systems</li>
          </ul>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md" data-aos="fade-left" data-aos-delay="100">
          <h4 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
            <span class="text-green-600 text-xl animate-pulse">‚úì</span> Cost Control Services
          </h4>
          <ul class="space-y-2 text-gray-600">
            <li class="service-item">Budget Development & Monitoring</li>
            <li class="service-item">Cost Forecasting & Analysis</li>
            <li class="service-item">Variation & Change Management</li>
            <li class="service-item">Financial Reporting & Dashboarding</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<footer class="bg-gray-900 text-white py-8">
  <div class="max-w-6xl mx-auto px-4">
    <div class="flex flex-col md:flex-row justify-between items-center">
      <div class="mb-6 md:mb-0" data-aos="fade-right">
        <a href="#home" class="text-2xl font-bold text-white">Planning & Cost Control</a>
        <p class="text-gray-400 mt-2">Alrwawaf Contracting Company</p>
      </div>
      
      <div class="flex gap-6" data-aos="fade-left">
        <a href="#reports" class="text-gray-400 hover:text-white transition hover:scale-110">Reports</a>
        <a href="#functions" class="text-gray-400 hover:text-white transition hover:scale-110">Functions</a>
        <a href="#about" class="text-gray-400 hover:text-white transition hover:scale-110">About</a>
        <a href="#contact" class="text-gray-400 hover:text-white transition hover:scale-110">Information</a>
      </div>
    </div>
    
    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400" data-aos="fade-up">
      <p>¬© 2025 Planning & Cost Control Department. All rights reserved.</p>
      <p class="mt-2 text-sm">This portal is for internal use only. Unauthorized access is prohibited.</p>
    </div>
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {

  AOS.init({
    duration: 800,
    once: true,
    offset: 100
  });

  // ENHANCED POWER BI REPORT VIEWER
  window.openReport = function(type) {
    const viewer = document.getElementById("viewer");
    const frame = document.getElementById("reportFrame");
    const loadingIndicator = document.getElementById("loadingIndicator");
    
    // Show loading state
    frame.style.opacity = '0';
    viewer.style.display = "block";
    loadingIndicator.style.display = "block";
    
    // Clear any previous content
    frame.src = "about:blank";
    
    // Define report URLs with error handling
    const reports = {
        "internal": {
            url: "https://app.powerbi.com/view?r=eyJrIjoiNjhkOGJlODQtOWU5Zi00NTUzLTg4ODgtYWU3MGNkNzcyNGE2IiwidCI6ImRmOWNkMjc4LWNjNTEtNGIyZC05YzI1LWY0YWVkZTZkYWQyNCIsImMiOjl9",
            title: "Internal vs Target 2025"
        },
        "issue": {
            url: "https://app.powerbi.com/reportEmbed?reportId=67fff2cf-1fde-4b87-b13f-b864f6cf1002&autoAuth=true&ctid=df9cd278-cc51-4b2d-9c25-f4aede6dad24",
            title: "Issue Tracking Dashboard"
        }
    };
    
    // Load the selected report
    if (reports[type]) {
        // Update viewer title
        document.querySelector('.viewer-title').textContent = reports[type].title;
        
        // Add timestamp to prevent caching issues
        const timestamp = new Date().getTime();
        const reportUrl = `${reports[type].url}&t=${timestamp}`;
        
        frame.src = reportUrl;
        
        // Add event listeners for the iframe
        frame.onload = function() {
            console.log(`Report loaded: ${reports[type].title}`);
            frame.style.opacity = '1';
            loadingIndicator.style.display = 'none';
            
            // Check if Power BI loaded successfully
            try {
                frame.contentWindow.postMessage({ action: 'ping' }, '*');
            } catch (e) {
                console.log("Power BI iframe loaded");
            }
        };
        
        frame.onerror = function() {
            console.error(`Failed to load report: ${reports[type].title}`);
            loadingIndicator.style.display = 'none';
            showErrorFallback(type);
        };
        
        // Set timeout for loading
        setTimeout(() => {
            if (frame.style.opacity === '0') {
                console.log("Report loading taking too long, showing fallback");
                loadingIndicator.style.display = 'none';
                showErrorFallback(type);
            }
        }, 10000);
    } else {
        console.error("Invalid report type");
        loadingIndicator.style.display = 'none';
        showErrorFallback(type);
    }
    
    viewer.scrollIntoView({ behavior: "smooth" });
    
    // Update browser history
    history.pushState({ report: type }, '', `#${type}-report`);
  };

  // Error fallback function
  function showErrorFallback(reportType) {
    const frame = document.getElementById("reportFrame");
    const reportTitle = reportType === "issue" ? "Issue Tracking Dashboard" : "Internal vs Target 2025";
    
    frame.srcdoc = `
        <!DOCTYPE html>
        <html>
        <head>
            <style>
                body {
                    font-family: 'Segoe UI', sans-serif;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    height: 100vh;
                    background: #f5f5f5;
                    margin: 0;
                }
                .error-container {
                    text-align: center;
                    padding: 40px;
                    background: white;
                    border-radius: 20px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                    max-width: 500px;
                }
                .error-icon {
                    font-size: 64px;
                    margin-bottom: 20px;
                }
                h2 {
                    color: #dc2626;
                    margin-bottom: 15px;
                }
                p {
                    color: #666;
                    margin-bottom: 20px;
                }
                .retry-btn {
                    background: #2563eb;
                    color: white;
                    border: none;
                    padding: 12px 30px;
                    border-radius: 8px;
                    font-size: 16px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .retry-btn:hover {
                    background: #1d4ed8;
                    transform: translateY(-2px);
                }
            </style>
        </head>
        <body>
            <div class="error-container">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h2>Report Loading Issue</h2>
                <p>${reportTitle} is taking longer than expected to load.</p>
                <p>This could be due to:</p>
                <ul style="text-align: left; color: #666;">
                    <li>Power BI service being temporarily unavailable</li>
                    <li>Network connectivity issues</li>
                    <li>Permission or authentication requirements</li>
                </ul>
                <button class="retry-btn" onclick="window.top.openReport('${reportType}')">
                    Retry Loading Report
                </button>
            </div>
        </body>
        </html>
    `;
    frame.style.opacity = '1';
  }

  // Close report function
  window.closeReport = function() {
    document.getElementById("viewer").style.display = "none";
    document.getElementById("reportFrame").src = "about:blank";
    document.getElementById("loadingIndicator").style.display = "none";
    history.pushState(null, '', location.pathname);
  };

  // Add back button support
  window.addEventListener('popstate', function(event) {
    if (event.state && event.state.report) {
      openReport(event.state.report);
    } else {
      document.getElementById("viewer").style.display = "none";
    }
  });

  // Enhanced BLOB CANVAS with animation
  const canvas = document.getElementById("blobCanvas");
  const ctx = canvas.getContext("2d");

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener("resize", resize);

  class Blob {
    constructor() {
      this.x = Math.random() * canvas.width;
      this.y = Math.random() * canvas.height;
      this.r = 60 + Math.random() * 60;
      this.vx = (Math.random() - 0.5) * 0.8;
      this.vy = (Math.random() - 0.5) * 0.8;
      this.targetX = this.x;
      this.targetY = this.y;
      this.speed = 0.02;
      this.time = Math.random() * Math.PI * 2;
      this.amplitude = 50 + Math.random() * 100;
    }
    
    draw() {
      this.time += 0.02;
      
      // Smooth movement with sine wave
      this.targetX = this.x + Math.sin(this.time * 0.5) * this.amplitude;
      this.targetY = this.y + Math.cos(this.time * 0.7) * this.amplitude;
      
      this.x += (this.targetX - this.x) * this.speed;
      this.y += (this.targetY - this.y) * this.speed;
      
      // Create pulsing effect
      const pulseRadius = this.r * (0.9 + 0.1 * Math.sin(this.time * 0.8));
      
      // Create gradient
      const g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, pulseRadius);
      g.addColorStop(0, "rgba(59, 130, 246, 0.8)");
      g.addColorStop(0.5, "rgba(59, 130, 246, 0.3)");
      g.addColorStop(1, "rgba(59, 130, 246, 0.1)");
      
      ctx.fillStyle = g;
      ctx.beginPath();
      ctx.arc(this.x, this.y, pulseRadius, 0, Math.PI * 2);
      ctx.fill();
      
      // Add glow effect
      ctx.shadowBlur = 30;
      ctx.shadowColor = "rgba(59, 130, 246, 0.5)";
      ctx.fill();
      ctx.shadowBlur = 0;
    }
    
    update() {
      if (this.x < -this.r || this.x > canvas.width + this.r) this.vx *= -1;
      if (this.y < -this.r || this.y > canvas.height + this.r) this.vy *= -1;
    }
  }

  const blobs = [...Array(5)].map(() => new Blob());
  
  (function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Add a subtle background gradient
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, "rgba(30, 58, 138, 0.1)");
    gradient.addColorStop(1, "rgba(37, 99, 235, 0.05)");
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    blobs.forEach(b => { b.update(); b.draw(); });
    requestAnimationFrame(animate);
  })();

  // Add scroll reveal animations for elements
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);

  // Observe all cards and sections
  document.querySelectorAll('.about-card, .contact-card, .stat-card').forEach(el => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(30px)';
    el.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
    observer.observe(el);
  });

  // Add hover sound effects (optional)
  document.querySelectorAll('.report-card, .func-card, .about-card').forEach(card => {
    card.addEventListener('mouseenter', () => {
      card.style.transform = card.style.transform + ' scale(1.05)';
    });
    
    card.addEventListener('mouseleave', () => {
      card.style.transform = card.style.transform.replace(' scale(1.05)', '');
    });
  });

});
</script>

</body>
</html>

